<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>World Incident Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html, body {
  margin: 0;
  height: 100%;
}

#map {
  height: 100vh;
  width: 100vw;
}

/* Panels styles (filters + legend) */
.panel { 
  position: absolute; 
  background:white; 
  border-radius:6px; 
  box-shadow:0 2px 10px rgba(0,0,0,0.3); 
  font-family:sans-serif; 
  z-index:1000; 
}

.panel-header { 
  display:flex; 
  justify-content:space-between; 
  padding:8px; 
  font-weight:bold; 
  background:#f0f0f0; 
}

.panel button { 
  background:none; 
  border:none; 
  font-size:16px; 
  cursor:pointer; 
}

.panel-content { 
  padding:8px; 
}

.collapsed .panel-content { 
  display:none; 
}

/* Filters panel */
#filters {
  bottom: 10px;
  right: 10px;
  width: 800px; 
  height: auto;
  transition: width 0.2s ease, height 0.2s ease;
}

#filters.collapsed {
  width: 100px;  
  height: 40px;  
}

/* Legend panel */
#legend {
  top: 10px;
  right: 10px;
  width: 300px;  
  height: auto;
  transition: width 0.2s ease, height 0.2s ease;
}

#legend.collapsed {
  width: 150px;  
  height: 40px;  
}

/* Columns and content */
.filter-columns { display:flex; gap:20px; }
.filter-columns .filter-column { display:flex; flex-direction:column; gap:4px; }
.filter-column label img { width:24px; height:24px; vertical-align:middle; margin-right:6px; }
.legend-row img { width:28px; height:28px; vertical-align:middle; margin-right:6px; }
.legend-row { margin-bottom:8px; }

/* Sidebar */
#sidebar {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 250px;
  display: flex;
  z-index: 1000;
  transform: translateX(-220px); /* closed: only hamburger visible */
  transition: transform 0.3s ease;
}

#sidebar:hover {
  transform: translateX(0); /* open on hover */
}

#sidebar.sidebar-open {
  transform: translateX(0); /* open on click */
}

#sidebar-content {
  width: 250px;
  height: 100%;
  background: rgba(255,255,255,0.97);
  box-shadow: 2px 0 10px rgba(0,0,0,0.25);
  padding: 12px;
  box-sizing: border-box;
}

#sidebar-handle {
  position: absolute;
  right: 0; /* always visible at the edge */
  top: 20px;
  width: 30px;
  height: 40px;
  background: white;
  border-radius: 0 6px 6px 0;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 2px 0 6px rgba(0,0,0,0.3);
  cursor: pointer;
  font-size: 20px;
  z-index: 1001;
}
</style>
</head>

<body>

<!-- Sidebar -->
<div id="sidebar">
  <div id="sidebar-content">
    <h3>Statistics</h3>
    <div id="stats-per-month"></div>
    <div id="stats-per-country"></div>
    <div id="stats-per-incident"></div>
  </div>
  <div id="sidebar-handle">&#9776;</div>
</div>

<!-- Map -->
<div id="map"></div>

<!-- Filters Panel -->
<div id="filters" class="panel collapsed">
  <div class="panel-header">
    <span>Filters</span>
    <button onclick="togglePanel('filters')">â–¾</button>
  </div>
  <div class="panel-content">
    <div class="filter-columns">
      <div class="filter-column">
        <label><input type="checkbox" value="drone" checked> <img src="icons/uav.png"> Drones</label>
        <label><input type="checkbox" value="jet" checked> <img src="icons/fighter-plane.png"> Jets</label>
        <label><input type="checkbox" value="balloon" checked> <img src="icons/balloon.png"> Balloons</label>
        <label><input type="checkbox" value="border" checked> <img src="icons/soldier.png"> Ground Border Crossing</label>
      </div>
      <div class="filter-column">
        <label><input type="checkbox" value="red" checked> ðŸ”´ Incidents confirmed to be caused by Russia</label>
        <label><input type="checkbox" value="orange" checked> ðŸŸ  Incidents suspected to be caused by Russia</label>
        <label><input type="checkbox" value="yellow" checked> ðŸŸ¡ Actor unknown</label>
        <label><input type="checkbox" value="green" checked> ðŸŸ¢ Sightings unverified</label>
        <label><input type="checkbox" value="blue" checked> ðŸ”µ Safety zone breaches</label>
      </div>
      <div class="filter-column">
        <label><input type="checkbox" value="airports" checked> <img src="icons/airport.png"> Airports</label>
        <label><input type="checkbox" value="militarybases" checked> <img src="icons/soldier.png"> Military bases</label>
        <label><input type="checkbox" value="infrastructure" checked> <img src="icons/nuclear-plant.png"> Infrastructure </label>
        <label><input type="checkbox" value="others" checked> <img src="icons/dot-square.png"> Others</label>
      </div>
      <div class="filter-column">
        <label><input type="checkbox" value="2025" checked> 2025</label>
        <label><input type="checkbox" value="2026" checked> 2026</label>
      </div>
    </div>
  </div>
</div>

<!-- Legend Panel -->
<div id="legend" class="panel">
  <div class="panel-header">
    <span>Legend</span>
    <button onclick="togglePanel('legend')">â–¾</button>
  </div>
  <div class="panel-content">
    <div class="legend-row"><img src="icons/uav.png"> Drone</div>
    <div class="legend-row"><img src="icons/fighter-plane.png"> Jet</div>
    <div class="legend-row"><img src="icons/balloon.png"> Balloon</div>
    <div class="legend-row"><img src="icons/base.png"> Ground Border Crossing</div>
    <div class="legend-row">ðŸ”´ Incident confirmed to be caused by Russia</div>
    <div class="legend-row">ðŸŸ  Incident suspected to be caused by Russia</div>
    <div class="legend-row">ðŸŸ¡ Actor unknown</div>
    <div class="legend-row">ðŸŸ¢ Sighting unverified</div>
    <div class="legend-row">ðŸ”µ Safety zone breach</div>
  </div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script src="map.js"></script>

<script>
/* Panel toggle */
function togglePanel(id) {
  document.getElementById(id).classList.toggle('collapsed');
}

/* Sidebar toggle */
const sidebar = document.getElementById('sidebar');
const handle = document.getElementById('sidebar-handle');

handle.addEventListener('click', (e) => {
  sidebar.classList.toggle('sidebar-open');
  e.stopPropagation(); // prevent click from bubbling
});
</script>

</body>
</html>
